**Express ä¸­é—´ä»¶ç³»ç»Ÿ** çš„è¯¦ç»†è®²è§£ï¼ŒåŒ…æ‹¬å…¨å±€ä¸­é—´ä»¶ã€è·¯ç”±ä¸­é—´ä»¶ã€é™æ€èµ„æºä¸­é—´ä»¶ã€è¯·æ±‚ä½“è§£æžä¸­é—´ä»¶ï¼Œä»¥åŠä½¿ç”¨æ³¨æ„äº‹é¡¹ðŸ‘‡

---

## ðŸŒ ä¸€ã€ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰ï¼Ÿ

ä¸­é—´ä»¶æ˜¯ **å‡½æ•°**ï¼Œåœ¨è¯·æ±‚åˆ°è¾¾è·¯ç”±å¤„ç†å™¨ä¹‹å‰è¢«è°ƒç”¨ï¼Œç”¨äºŽæ‹¦æˆªã€ä¿®æ”¹è¯·æ±‚æˆ–å“åº”ï¼Œæˆ–è€…ç»ˆæ­¢è¯·æ±‚å¤„ç†æµç¨‹ã€‚

### ä¸­é—´ä»¶å‡½æ•°æ ¼å¼ï¼š
```js
(req, res, next) => { /* your logic */ }
```

è°ƒç”¨ `next()` è¡¨ç¤ºç»§ç»­ä¼ é€’è¯·æ±‚ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼›å¦åˆ™è¯·æ±‚ä¼šè¢«â€œå¡ä½â€ã€‚

---

## ðŸ“Œ äºŒã€å…¨å±€ä¸­é—´ä»¶ï¼ˆåº”ç”¨çº§ï¼‰

### ç¤ºä¾‹ 1ï¼šæ—¥å¿—ä¸­é—´ä»¶ï¼ˆæ‰€æœ‰è¯·æ±‚éƒ½ä¼šæ‰§è¡Œï¼‰
```js
app.use((req, res, next) => {
  console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`);
  next(); // ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶
});
```

---

## ðŸš ä¸‰ã€è·¯ç”±ä¸­é—´ä»¶ï¼ˆå±€éƒ¨ï¼‰

åªå¯¹ç‰¹å®šè·¯ç”±ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼š

```js
const checkAuth = (req, res, next) => {
  if (req.query.token === '123') {
    next();
  } else {
    res.status(401).send('Unauthorized');
  }
};

app.get('/secure', checkAuth, (req, res) => {
  res.send('Access granted!');
});
```

---

## ðŸ“ å››ã€é™æ€èµ„æºä¸­é—´ä»¶

å†…ç½®ä¸­é—´ä»¶ `express.static()` ç”¨äºŽæ‰˜ç®¡é™æ€æ–‡ä»¶ï¼ˆHTMLã€CSSã€JSã€å›¾ç‰‡ç­‰ï¼‰ï¼š

```js
app.use(express.static('public')); // è®¿é—® public æ–‡ä»¶å¤¹

// å‡è®¾ public ä¸­æœ‰ index.htmlï¼Œå¯ä»¥ç›´æŽ¥é€šè¿‡ http://localhost:3000/index.html è®¿é—®
```

---

## ðŸ§¾ äº”ã€èŽ·å–è¯·æ±‚ä½“æ•°æ®çš„ä¸­é—´ä»¶

### 1. è§£æž JSON æ ¼å¼
```js
app.use(express.json());
```

### 2. è§£æžè¡¨å•æ ¼å¼ï¼ˆx-www-form-urlencodedï¼‰
```js
app.use(express.urlencoded({ extended: true }));
```

ç¤ºä¾‹ POST è·¯ç”±ï¼š
```js
app.post('/login', (req, res) => {
  const { username, password } = req.body;
  res.send(`ç”¨æˆ·åï¼š${username}, å¯†ç ï¼š${password}`);
});
```

---

## âš ï¸ å…­ã€ä½¿ç”¨æ³¨æ„äº‹é¡¹

| æ³¨æ„äº‹é¡¹ | è¯´æ˜Ž |
|----------|------|
| ä¸­é—´ä»¶é¡ºåº | ä¸­é—´ä»¶æ˜¯**æŒ‰é¡ºåºæ‰§è¡Œ**çš„ï¼Œå…ˆå®šä¹‰çš„å…ˆæ‰§è¡Œ |
| `next()` å¿…é¡»è°ƒç”¨ | å¦åˆ™è¯·æ±‚ä¼šå¡ä½ï¼Œä¸ç»§ç»­æ‰§è¡ŒåŽç»­ä¸­é—´ä»¶æˆ–è·¯ç”± |
| é”™è¯¯å¤„ç†ä¸­é—´ä»¶ | ä¸­é—´ä»¶ä¸­æ•èŽ·é”™è¯¯æ—¶è¦è°ƒç”¨ `next(err)`ï¼ŒExpress ä¼šè‡ªåŠ¨è¿›å…¥é”™è¯¯å¤„ç†ä¸­é—´ä»¶ |
| é™æ€ä¸­é—´ä»¶è¦æ”¾å‰é¢ | å¦åˆ™å¯èƒ½è¢«å…¶ä»–ä¸­é—´ä»¶æˆ–è·¯ç”±æ‹¦æˆª |
| ä¸è¦æ»¥ç”¨å…¨å±€ä¸­é—´ä»¶ | å»ºè®®ç”¨å±€éƒ¨ä¸­é—´ä»¶æé«˜æ€§èƒ½ä¸Žå¯ç»´æŠ¤æ€§ |

---

## ðŸŽ ä¸ƒã€å®Œæ•´ç¤ºä¾‹

```js
const express = require('express');
const app = express();
const port = 3000;

// ä¸­é—´ä»¶
app.use(express.json());
app.use(express.urlencoded({ extended: true }));
app.use(express.static('public'));

// å…¨å±€æ—¥å¿—ä¸­é—´ä»¶
app.use((req, res, next) => {
  console.log(`[LOG] ${req.method} ${req.url}`);
  next();
});

// è·¯ç”±ä¸­é—´ä»¶ç¤ºä¾‹
const auth = (req, res, next) => {
  if (req.query.token === '123') next();
  else res.status(401).send('æœªæŽˆæƒ');
};

app.get('/public-info', (req, res) => res.send('Everyone can see this'));

app.get('/private-info', auth, (req, res) => res.send('This is protected'));

app.post('/form', (req, res) => {
  res.send(req.body);
});

app.listen(port, () => {
  console.log(`App running at http://localhost:${port}`);
});
```
