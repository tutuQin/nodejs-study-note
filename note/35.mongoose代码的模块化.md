
---

## âœ… ç›®å½•ç»“æ„ç¤ºä¾‹

```
project/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.config.js         # æ•°æ®åº“é…ç½®
â”œâ”€â”€ models/
â”‚   â””â”€â”€ user.model.js        # ç”¨æˆ·æ¨¡å‹
â”œâ”€â”€ services/
â”‚   â””â”€â”€ user.service.js      # ç”¨æˆ·æœåŠ¡å±‚
â”œâ”€â”€ db/
â”‚   â””â”€â”€ mongoose.js          # æ•°æ®åº“è¿æ¥æ¨¡å—
â”œâ”€â”€ index.js                 # é¡¹ç›®å…¥å£
```

---

## ğŸ“ 1. `config/db.config.js` â€”â€” é…ç½®æ–‡ä»¶

```js
// config/db.config.js
module.exports = {
  host: 'localhost',
  port: 27017,
  dbName: 'modularDemo',
  options: {
    useNewUrlParser: true,
    useUnifiedTopology: true
  }
}
```

---

## ğŸ“ 2. `db/mongoose.js` â€”â€” è¿æ¥æ•°æ®åº“æ¨¡å—

```js
// db/mongoose.js
const mongoose = require('mongoose')
const config = require('../config/db.config')

const uri = `mongodb://${config.host}:${config.port}/${config.dbName}`

const connectDB = async () => {
  try {
    await mongoose.connect(uri, config.options)
    console.log('âœ… MongoDB connected successfully')
  } catch (error) {
    console.error('âŒ MongoDB connection failed:', error)
    process.exit(1)
  }
}

module.exports = connectDB
```

---

## ğŸ“ 3. `models/user.model.js` â€”â€” ç”¨æˆ·æ¨¡å‹

```js
// models/user.model.js
const mongoose = require('mongoose')

const userSchema = new mongoose.Schema({
  name: { type: String, required: true },
  age: { type: Number, min: 0 },
  email: { type: String, unique: true, required: true },
  isActive: { type: Boolean, default: true }
})

module.exports = mongoose.model('User', userSchema)
```

---

## ğŸ“ 4. `services/user.service.js` â€”â€” ç”¨æˆ·æœåŠ¡æ“ä½œ

```js
// services/user.service.js
const User = require('../models/user.model')

const createUser = async (data) => await User.create(data)

const getAllUsers = async () => await User.find()

const findUserByEmail = async (email) => await User.findOne({ email })

const updateUser = async (id, data) =>
  await User.findByIdAndUpdate(id, data, { new: true })

const deleteUser = async (id) => await User.findByIdAndDelete(id)

module.exports = {
  createUser,
  getAllUsers,
  findUserByEmail,
  updateUser,
  deleteUser
}
```

---

## ğŸ“ 5. `index.js` â€”â€” å¯åŠ¨é¡¹ç›®ã€æµ‹è¯•æœåŠ¡

```js
// index.js
const connectDB = require('./db/mongoose')
const userService = require('./services/user.service')

const run = async () => {
  await connectDB()

  // æ’å…¥ä¸€ä¸ªæ–°ç”¨æˆ·
  const newUser = await userService.createUser({
    name: 'Tom',
    age: 25,
    email: 'tom@example.com'
  })
  console.log('ğŸ†• Created user:', newUser)

  // æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·
  const users = await userService.getAllUsers()
  console.log('ğŸ‘¥ All users:', users)
}

run()
```

---

## ğŸ“ è¯´æ˜

- æ‰€æœ‰é…ç½®é›†ä¸­åœ¨ `config/db.config.js`
- è¿æ¥é€»è¾‘ç‹¬ç«‹åœ¨ `db/mongoose.js`
- æ¨¡å‹å’ŒæœåŠ¡æ¨¡å—åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤
- å¯æ–¹ä¾¿æ¥å…¥ Expressã€Koa ç­‰åç«¯æ¡†æ¶

---